<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generador de Parejas</title>
</head>
<body>
    <header>
        <h1>Programa para Generar Parejas</h1>
    </header>

    <h2>Agregar Miembros</h2>
    <input type="text" id="nuevoMiembro" placeholder="Escribe un nombre">
    <button id="agregarMiembro">Agregar miembro</button>

    <h2>Lista de Miembros</h2>
    <ul id="miembros"></ul>

    <button id="generarCombinaciones">Generar<br>Combinaciones</button>

    <h2>Combinaciones de Parejas</h2>
    <ul id="combinaciones"></ul>

    <button id="seleccionAleatoria">Tomar parejas<br>aleatoriamente</button>
    <p id="textoParejasAleatorias"></p>
    <ul id="listaParejasAleatorias"></ul>

    <script>
        const listaMiembros = document.querySelector('#miembros');
        const inputMiembro = document.querySelector('#nuevoMiembro');
        const botonAgregar = document.querySelector('#agregarMiembro');
        const botonGenerarCombinaciones = document.querySelector('#generarCombinaciones');
        const listaCombinaciones = document.querySelector('#combinaciones');
        const botonSeleccionAleatoria = document.querySelector('#seleccionAleatoria');
        const listaParejasAleatorias = document.querySelector('#listaParejasAleatorias');

        // Array global para guardar los nombres de los miembros
        let miembros = [];

        // Función para agregar miembro
        botonAgregar.addEventListener('click', () => {
            const nombre = inputMiembro.value.trim();
            if (nombre) {
                miembros.push(nombre);  // Agregar el nuevo miembro al array
                agregarMiembroALaLista(nombre);  // Añadir a la lista visible
                inputMiembro.value = '';  // Limpiar el input
            }
        });

        // Función para agregar un miembro a la lista visual
        function agregarMiembroALaLista(nombre) {
            const li = document.createElement('li');
            const span = document.createElement('span');
            span.textContent = nombre;

            // Botón para eliminar miembro
            const botonEliminar = document.createElement('button');
            botonEliminar.textContent = 'X';
            botonEliminar.addEventListener('click', () => {
                li.remove();
                miembros = miembros.filter(miembro => miembro !== nombre);  // Eliminar del array
            });

        // Botón para editar miembro
        const botonEditar = document.createElement('button');
        botonEditar.textContent = 'Editar';
        botonEditar.addEventListener('click', () => {
            if (botonEditar.textContent === 'Editar') {
                const inputEditar = document.createElement('input');
                inputEditar.type = 'text';
                inputEditar.value = span.textContent;
                li.replaceChild(inputEditar, span);  // Reemplazar el texto con el input
                botonEditar.textContent = 'Guardar';
            } else {
                const nuevoNombre = li.querySelector('input').value.trim();
                if (nuevoNombre) {
                    span.textContent = nuevoNombre;  // Actualizar el nombre en el span
                    miembros[miembros.indexOf(nombre)] = nuevoNombre;  // Actualizar en el array
                    li.replaceChild(span, li.querySelector('input'));  // Reemplazar el input con el span
                    botonEditar.textContent = 'Editar';
                } else {
                    alert('El nombre no puede estar vacío.');
                }
            }
        });


            // Botón para pausar/despausar miembro
            const botonPausar = document.createElement('button');
            botonPausar.textContent = '||'; 
            botonPausar.addEventListener('click', () => {
                span.classList.toggle('pausado');
                botonPausar.textContent = span.classList.contains('pausado') ? '▶' : '||';
            });

            // Añadir elementos al <li>
            li.appendChild(span);
            li.appendChild(botonEditar);
            li.appendChild(botonPausar);
            li.appendChild(botonEliminar);
            listaMiembros.appendChild(li);
        }



        // Declarar combinaciones fuera del bloque para que sea accesible en otros lugares
        let combinaciones = [];
        // Función para generar combinaciones de parejas
        botonGenerarCombinaciones.addEventListener('click', () => {
            listaCombinaciones.innerHTML = '';  // Limpiar la lista de combinaciones
            combinaciones = [];  // Reiniciar el array global para que esté vacío antes de agregar nuevas combinaciones

            // Generar todas las combinaciones posibles de 2 en 2
            for (let i = 0; i < miembros.length; i++) {
                for (let j = i + 1; j < miembros.length; j++) {
                    combinaciones.push([miembros[i], miembros[j]]);
                }
            }

            // Mostrar las combinaciones en la lista
            combinaciones.forEach((pareja) => {
                const li = document.createElement('li');
                li.textContent = `(${pareja[0]} y ${pareja[1]})`;
                listaCombinaciones.appendChild(li);
            });
        });


        // Función para seleccionar parejas aleatoriamente
        botonSeleccionAleatoria.addEventListener('click', () => {
            let parejasDeseadas = miembros.length / 2;  // Número de parejas deseadas

            // Algoritmo de Fisher-Yates para barajar el array de combinaciones
            function shuffleArray(array) {
                for (let i = array.length - 1; i > 0; i--) {
                    // Generar un índice aleatorio
                    const j = Math.floor(Math.random() * (i + 1));
                    
                    // Intercambiar elementos array[i] y array[j]
                    [array[i], array[j]] = [array[j], array[i]];
                }
                return array;
            }

            // Barajar el array de combinaciones globalmente
            const combinacionesBarajadas = shuffleArray([...combinaciones]);  // Usar una copia para no modificar el array original
           
            let parejasAleatorias = [];  //Array donde agregaremos las parejas que vayamos seleccionando aleatoriamente
            let personasUsadas = new Set();  // Set para rastrear las personas que ya están en parejas seleccionadas
            

            //funcion para seleccionar elemento aleatoriamente
            function seleccionarElementoAleatorio(array) {
                const indiceAleatorio = Math.floor(Math.random() * array.length);
                return array[indiceAleatorio];
            }

            // Bucle para seleccionar parejas sin repetir personas
            while  (parejasAleatorias.length < parejasDeseadas) {
                let elementoAleatorio = seleccionarElementoAleatorio(combinacionesBarajadas);
                // Verificar si alguna persona en la pareja ya fue seleccionada
                if (!personasUsadas.has(elementoAleatorio[0]) && !personasUsadas.has(elementoAleatorio[1])) {
                    parejasAleatorias.push(elementoAleatorio);  // Agregar la pareja a las seleccionadas
                    personasUsadas.add(elementoAleatorio[0]);  // Marcar a la primera persona como usada
                    personasUsadas.add(elementoAleatorio[1]);  // Marcar a la segunda persona como usada
                }
            }        

            // Mostrar las parejas seleccionadas
            listaParejasAleatorias.innerHTML = '';  // Limpiar la lista 
            parejasAleatorias.forEach((pareja) => {
                const li = document.createElement('li');
                li.textContent = `(${pareja[0]} y ${pareja[1]})`;
                listaParejasAleatorias.appendChild(li);
            });
        });





    </script>

    <style>
        .pausado {
            text-decoration: line-through; /* Muestra a los miembros pausados con una línea */
            color: grey; /* Cambia el color a gris */
        }
    </style>
</body>
</html>